<extends src="layout.html">
  <block name="memories-menu-item">
    <a href="/memories" class="text-white bg-teal-800 rounded-md">Memories</a>
  </block>
  <block name="title">Memories</block>
  <block name="content">
    <div id="searchbox" class="flex flex-none mx-auto p-4 w-full max-w-screen-xl border-b sm:pl-36 md:pl-56 lg:pl-72">
      <input
        type="search"
        placeholder="Search for program, speaker, topics, dates etc."
        class="placeholder-gray-300 block px-3 py-2 w-full leading-6 border border-r-0 border-gray-300 focus:border-gray-300 rounded-l-md rounded-none focus:outline-none appearance-none focus:ring-0"
      />
      <button type="submit" class="sm:px4 px-2 text-white font-semibold bg-teal-800 border-l-0 border-gray-300 rounded-r-md shadow-sm">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6 sm:hidden">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>
        <span class="hidden sm:inline">Search</span>
      </button>
    </div>
    <div class="flex flex-1 mx-auto w-full max-w-screen-xl sm:overflow-y-hidden">
      <div id="filter-panel" class="fixed z-20 top-0 open:flex hidden flex-col w-64 max-w-full h-full text-sm bg-white md:static md:z-auto md:flex md:w-1/5 md:max-w-sm">
        <div class="flex-none p-2 text-center text-teal-800 font-bold bg-submarine-500 uppercase md:hidden">Filter</div>
        <div class="flex-grow p-2 pb-40 pt-0 overflow-x-hidden overflow-y-auto">
          <div id="gurus-list">
            <template>
              <span>Initiating Guru(s)</span>
              <p class="text-xs font-normal lowercase">[Sorted by decreasing count of matching records]</p>
            </template>
          </div>
          <div id="language-list"></div>
          <div id="program-name-list"></div>
          <div id="speaker-country-list"></div>
          <div id="duration-menu"></div>
        </div>
        <div class="flex-none p-2 border-t md:hidden">
          <button data-filter-toggle class="p-2 w-full text-white font-semibold bg-teal-800 rounded-md shadow-sm uppercase">Close</button>
        </div>
      </div>
      <main class="flex-grow pb-40 px-2 w-full sm:px-4 sm:w-4/5 sm:overflow-y-auto">
        <div class="flex items-center my-3">
          <!-- Filter button -->
          <button data-filter-toggle class="inline-flex items-center mr-4 px-4 py-2 w-24 text-white font-semibold bg-teal-800 border-gray-300 rounded-md shadow-sm space-x-1 md:hidden">
            <!-- Heroicon name: solid/filter -->
            <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
              <path
                fill-rule="evenodd"
                d="M3 3a1 1 0 011-1h12a1 1 0 011 1v3a1 1 0 01-.293.707L12 11.414V15a1 1 0 01-.293.707l-2 2A1 1 0 018 17v-5.586L3.293 6.707A1 1 0 013 6V3z"
                clip-rule="evenodd"
              />
            </svg>
            <span>Filter</span>
          </button>
          <span id="stats" class="whitespace-nowrap text-sm"></span>
          <span id="loading" class="text-gray-500 text-sm">Loading…</span>
        </div>
        <div id="hits">
          <template id="item-template">
            <article class="items-center pb-4 pl-0 pr-0 max-w-screen-mobile-s sm:pl-8 sm:pr-0 md:pl-8 md:pr-0">
              <!-- Video player -->
              <div class="mx-auto flex items-center justify-center" x-data="{ 'showModal': false }" @keydown.escape="showModal = false" x-cloak>
                <img class="w-80 h-56 border-t-2 rounded-lg sm:w-80 md:w-80 sm:h-52 md:h-52" src="https://img.youtube.com/vi/{{{videoId}}}/sddefault.jpg" @click="showModal = true"></img>
                <!--Overlay-->
                <div class="overflow-auto" x-show="showModal" :class="{ 'absolute inset-0 flex items-center justify-center': showModal }">
                  <!--Dialog-->
                  <div id="dialog" class="div-float items-baseline bg-gray-900 max-w-md w-screen sm:max-w-screen-2xl md:max-w-md mx-auto rounded shadow-lg
                  pb-6 text-left px-6 pt-2" x-show="showModal"
                  x-transition:enter="ease-out duration-300"
                  x-transition:enter-start="opacity-0 scale-90"
                  x-transition:enter-end="opacity-100 scale-100">
                  <!-- @click.away="showModal = false" -->
                 <!--  Minimize, Close buttons Start -->
                  <div class="text-right">
                  <button id="btnMinimize" @click="showModal = false;document.getElementById('dialogStrip').style.display = 'block';">
                    <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="20" height="20" viewBox="0 0 64 64" style=" fill:white;"
                       enable-background="new 0 0 64 64" xml:space="preserve">
                      <g>
                        <line fill="none" stroke="white" stroke-width="6" stroke-miterlimit="10" x1="14" y1="31" x2="50" y2="31"/>
                      </g>
                    </svg>
                  </button>
                  &nbsp;
                  <button id="btnCross" @click="showModal = false;">
                    <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="20" height="20" viewBox="0 0 32 32" style=" fill:white;">
                      <path d="M 7.21875 5.78125 L 5.78125 7.21875 L 14.5625 16 L 5.78125 24.78125 L 7.21875 26.21875 L 16 17.4375 L 24.78125 26.21875 L 26.21875 24.78125 L 17.4375 16 L 26.21875 7.21875 L 24.78125 5.78125 L 16 14.5625 Z"></path>
                    </svg>
                  </button>
                </div><!--  Minimize, Close buttons End -->
                 <!--  Player Area Start -->
                 <div class="flex items-center justify-center">
                    <div class="w-full h-full max-w-3xl">
                      <div class="ta-youtube ta-youtube--perspective border bg-gray-800 rounded-lg shadow-xl overflow-hidden max-w-3xl" style="max-height: 200px"
                        x-data="taYoutube()" x-init="init()" data-id="{{{videoId}}}" data-remember="false" data-autoplay="false" data-start_at="200" data-end_at="220">
                        <button href="play" class="absolute inset-0 w-full h-full flex items-center justify-center cursor-pointer" x-on:click.prevent="show()" x-show="!active">
                          <!--  Background image -->
                          <img class="ta-youtube-background ta-youtube-anim ta-youtube-anim-kenburns" src="https://img.youtube.com/vi/{{{videoId}}}/0.jpg" alt="Background Image" title="Background Image" />
                          <!--  Darkening gradient -->
                          <div class="ta-youtube-gradient ta-youtube-gradient-dark"></div>
                          <!--  Play button -->
                          <div class="ta-youtube-button flex items-center justify-center text-white transform duration-200 hover:scale-110" x-ref="button" alt="Show youtube video">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="fill-current w-full">
                              <title>play-circle</title>
                              <path d="M371.7 238l-176-107c-15.8-8.8-35.7 2.5-35.7 21v208c0 18.4 19.8 29.8 35.7 21l176-101c16.4-9.1 16.4-32.8.0-42zM504 256C504 119 393 8 256 8S8 119 8 256s111 248 248 248 248-111 248-248zm-448 0c0-110.5 89.5-2e2 2e2-2e2s2e2 89.5 2e2 2e2-89.5 2e2-2e2 2e2S56 366.5 56 256z"></path>
                            </svg>
                          </div>
                        </button>
                        <!--  YouTube player -->
                        <template x-if="active">
                          <iframe class="absolute inset-0 w-full h-full" :src="url" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        </template>
                      </div>
                    </div>
                  </div>
                 <!--  Player Area end -->
                 <!--Footer-->
                 <!-- <button class="modal-close mt-3 px-4 bg-teal-800 p-3 rounded-lg text-white hover:bg-teal-400" @click="showModal = false;">Close</button> -->
                  </div>
                  <!--/Dialog -->
                </div><!-- /Overlay -->
              </div>
              <span id="dialogStrip" class="div-float-strip hidden h-10 items-baseline bg-gray-900 max-w-md w-screen sm:max-w-screen-2xl
              md:max-w-md mx-auto rounded shadow-lg pb-6 text-left px-6 pt-2">
              <button id="btnMinimize" onclick="document.getElementById('dialog').style.display = 'block';document.getElementById('dialogStrip').style.display = 'none';">
                <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="20" height="20" viewBox="0 0 64 64" style=" fill:white;"
                   enable-background="new 0 0 64 64" xml:space="preserve">
                  <g>
                    <line fill="none" stroke="white" stroke-width="6" stroke-miterlimit="10" x1="14" y1="31" x2="50" y2="31"/>
                  </g>
                </svg>
              </button>
              &nbsp;
              <button id="btnCross" onclick="document.getElementById('dialogStrip').style.display = 'none';">
                <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="20" height="20" viewBox="0 0 32 32" style=" fill:white;">
                  <path d="M 7.21875 5.78125 L 5.78125 7.21875 L 14.5625 16 L 5.78125 24.78125 L 7.21875 26.21875 L 16 17.4375 L 24.78125 26.21875 L 26.21875 24.78125 L 17.4375 16 L 26.21875 7.21875 L 24.78125 5.78125 L 16 14.5625 Z"></path>
                </svg>
              </button>
            </span>
              <h3 class="break-words font-semibold" title="Speaker name">
                {{#helpers.highlight}} { "attribute": "speakerName" } {{/helpers.highlight}},
                <span
                  title="
                          {{#gurus.0.fullName}}{{gurus.0.fullName}}{{/gurus.0.fullName}}
                          {{#gurus.1.fullName}}, {{gurus.1.fullName}}{{/gurus.1.fullName}}
                          {{#gurus.2.fullName}}, {{gurus.2.fullName}}{{/gurus.2.fullName}}
                          "
                  class="text-xs"
                >
                  {{#gurus.0.abbreviation}}{{gurus.0.abbreviation}}{{/gurus.0.abbreviation}} {{#gurus.1.abbreviation}}, {{gurus.1.abbreviation}}{{/gurus.1.abbreviation}} {{#gurus.2.abbreviation}},
                  {{gurus.2.abbreviation}}{{/gurus.2.abbreviation}}
                </span>
              </h3>
              <!-- Tag line -->
              <div
                class="children:last:border-0 flex flex-wrap content-between align-baseline children:mr-1 children:mt-1 children:pr-1 w-80 text-xs children:border-r children:border-gray-300 sm:w-72 md:w-72"
              >
                <div title="Language">{{language}}</div>
                <div title="Speaker's Country">{{speakerCountry}}</div>
                <div title="Date">{{dateForHumans}}</div>
                <div title="Duration">{{durationForHumans}}</div>
                <!-- Feedback -->
                <a href="{{feedbackURL}}" target="_blank" class="inline-flex space-x-1" title="Help us improve! Give feedback about the Speaker’s Name or Introduction, etc of this video">
                  <svg class="w-4 h-full stroke-current" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"
                    />
                  </svg>
                </a>
              </div>
              <p class="text-xs font-bold">{{programName}}</p>
              <p
                class="align-top w-80 text-justify text-xs sm:w-72 md:w-72"
                x-data="{ isCollapsed: false, maxLength: 170, originalContent: '', content: '' }"
                x-init="originalContent = $el.firstElementChild.textContent.trim(); content = originalContent.slice(0, maxLength)"
              >
                <span x-text="isCollapsed ? originalContent : content"> {{{speakerIntro}}} </span>
                <button class="text-teal-800 font-bold" @click="isCollapsed = !isCollapsed" x-show="originalContent.length > maxLength" x-text="isCollapsed ? 'Read less' : '...Read more'"></button>
              </p>
            </article>
          </template>
        </div>
        <div id="pagination" class="my-2 w-full"></div>
        <div id="results-footer" class="hidden p-2 text-center text-gray-500 text-sm">
          <p>Please Note: The results displayed above are not in any particular order of seniority, date, etc.</p>
          <p>
            You can find more Memories recordings on the following YouTube channels, while we collate all of them here:<br />
            <a href="https://www.youtube.com/channel/UCfYqnuIc-NjbX1LfGFxCvYg" target="_blank" class="text-blue-900 underline">Remembering Srila Gurudeva</a>,
            <a href="https://www.youtube.com/playlist?list=PLpNgpvUJOl86QK8Yvx7pzvb8a1aQaM4j9" target="_blank" class="text-blue-900 underline">Gurudeva Memories 2021</a>,
            <a href="https://www.youtube.com/channel/UCWioFce4v7kjGfTfHUwvN0Q" target="_blank" class="text-blue-900 underline">Fond Memories of Srila Gurudeva</a>.
          </p>
          <p>Progressively, newer Memories videos will be added here regularly. So we welcome you to come back to hear some more!</p>
        </div>
      </main>
    </div>
  </block>
  <block name="scripts">
    <script type="module" src="./memories.js"></script>
	  <script src="https://cdn.jsdelivr.net/gh/markusantonwolf/ta-youtube@2.x.x/dist/js/ta-youtube.min.js"></script>
  </block>
</extends>
